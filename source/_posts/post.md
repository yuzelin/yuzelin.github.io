---
title: Java格式化输出的转换符和标志
date: 2020-09-03 14:41:01
tags:
  - Java
  - readiong notes
categories:
  - Java
  - Core Java Volume Ⅰ
---

&emsp;&emsp;Java 5沿用了C中printf方法，可以为System.out.printf提供格式说明符来控制输出的格式。

&emsp;&emsp;通过查看PrintStream.printf的源码，追踪到java.util.Formatter类，该类定义了对格式化串的一系列解析方法。这里只看格式说明符相关的定义。首先是格式说明符的格式：

```java
// %[argument_index$][flags][width][.precision][t]conversion
private static final String formatSpecifier
    = "%(\\d+\\$)?([-#+ 0,(\\<]*)?(\\d+)?(\\.\\d+)?([tT])?([a-zA-Z%])";
```

&emsp;&emsp;formatSpecifier是格式说明符的正则表达式，通过它本身的内容以及注释可知，格式说明符以'%'开始，后续依次是：

- argument_index-参数索引（可选），后面要加'$'。指定了要格式化的参数索引。注意，这里索引值从1开始，避免了与后面的标志'0'混淆；
- flags-标志（可选）。从正则表达式中可知一共8种，*表明可以有多个标志；
- width-字段宽度（可选）。最少要输出的字符数。不考虑标记的情况下，若字段宽度大于实际宽度则在前面补空格；若小于则按实际宽度输出；
- precision-精度（可选），前面要加'.'。浮点数小数点后保留位数。若精度大于实际位数则在后面补0；若小于则四舍五入；
- t或T（可选）。用于日期时间的格式化，已经过时，现在应该使用java.time中的方法；
- conversion-转换符（必选）。根据正则表达式，这里可以是大小写的字母和%，实际上大部分用于格式化日期时间，必须跟在t后，除去这一部分，共13种。

&emsp;&emsp;下面对转换符和标志做说明。转换符指示要格式化的数值的类型，在Formatter中的私有类Conversion可以看到所有合法的转换符，在表1中列出：

<center>表1 用于printf的转换符</center>

| 转换符 | 类型                                                         |
| :----- | ------------------------------------------------------------ |
| d      | 十进制整数                                                   |
| o      | 八进制整数                                                   |
| x \| X | 十六进制整数                                                 |
| e \| E | 指数浮点数（科学计数法表示）<br />输出中的e的大小写根据转换符决定 |
| g \| G | 通用浮点数（e和f中较短的一个）                               |
| f      | 十进制浮点数                                                 |
| a \| A | 十六进制浮点数                                               |
| c \| C | 字符                                                         |
| b \| B | 布尔（true和false。如果参数不是<br />boolean类型，则参数不为null打印true） |
| s \| S | 字符串                                                       |
| h \| H | 散列值                                                       |
| n      | 行分隔符                                                     |
| %      | 百分号                                                       |

&emsp;&emsp;标志指示输出的外观，一个说明符中可以使用多个标志。表2列出所有的标志：

<center>表2 用于printf的标志</center>

| 标志 | 目的                                                     |
| ---- | -------------------------------------------------------- |
| -    | 左对齐（必须给出字段宽度<br />相当于在后面补不够的空格） |
| #    | 使用替换形式<br />（根据具体的类型）                     |
| +    | 打印正数的'+'号                                          |
| 空格 | 在正数之前添加空格                                       |
| 0    | 数字前面补0（必须给出字段宽度）                          |
| ,    | 数字添加分组分隔符                                       |
| (    | 对负数，显示括在括号内的绝对值                           |
| <    | 指示上一个说明的参数                                     |

